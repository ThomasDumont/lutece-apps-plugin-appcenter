<#macro tabs2 tab application errors infos user >
<div class="jumbotron">
	<h1>${application.code!}-${application.name}</h1>
	<p class="lead">${application.description}</p>
	<hr>
	<p class="lead">
		<a class="btn btn-primary pull-right" href="jsp/site/Portal.jsp?page=application" title="Mes applications">
			<span class="fa fa-home"></span>   
		</a>
		<#if user.admin>
		<button type="button" class="btn btn-primary pull-right" data-toggle="modal" data-target="#ModalModify" title="#i18n{appcenter.modify_application.buttonModifyAppDescription}">
			<span class="fa fa-edit"></span>
		</button>
		<button type="button" class="btn btn-primary pull-right" data-toggle="modal" data-target="#ModalAddUser" title="#i18n{appcenter.modify_application.buttonAddUser}">
			<span class="fa fa-user-plus"></span>
		</button>
		<a class="btn btn-danger pull-right" href="jsp/site/Portal.jsp?page=application&action=confirmRemoveApplication&id=${application.id}" title="#i18n{portal.util.labelDelete}">
				<span class="fa fa-trash"></span>
		</a>
		</#if>
	</p>
</div>
<br>    
<@messages errors=errors />
<@messages infos=infos />
<#if tab="general">
	<#assign collapseAccordion=0>
<#elseif tab="sources"  || tab="jobs"  || tab="fastdeploy">
	<#assign collapseAccordion=1>
<#else>	
	<#assign collapseAccordion=2>
</#if>

<div class="row">
	<div class="col-xs-12 col-sm-3">
		<div class="list-group">
			<a class="list-group-item<#if tab="general"> active</#if>" id="generalTab" href="jsp/site/Portal.jsp?page=application&view=modifyApplication&id=${application.id}">
				Demandes en cours
			</a>
		</div>
		<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
			<div class="panel panel-default">
				<div class="panel-heading" role="tab" id="headingOne">
				  <h4 class="panel-title">
					<a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
					  Applications
					</a>
				  </h4>
				</div>
				<div id="collapseOne" class="panel-collapse collapse <#if collapseAccordion=1>in</#if>" role="tabpanel" aria-labelledby="headingOne">
				  <div class="panel-body">
					<ul class="nav nav-pills nav-stacked" id="navTabs" role="tablist">
						<li class="<#if tab="sources"> active</#if>" id="sourcesTab"><a href="jsp/site/Portal.jsp?page=sources&id=${application.id}">#i18n{module.appcenter.sources.tabs.sources}</a></li>
						<li class="<#if tab="jobs"> active</#if>" id="jobsTab"><a href="jsp/site/Portal.jsp?page=jobs&id=${application.id}">#i18n{appcenter.tabs.jobs}</a></li>
						<li class="<#if tab="fastdeploy"> active</#if>" id="fastdeployTab"><a href="jsp/site/Portal.jsp?page=fastdeploy&id=${application.id}">Fast de ploy</a></li>
					</ul>
				  </div>
				</div>
			</div>
			<div class="panel panel-default">
				<div class="panel-heading" role="tab" id="headingTwo">
				  <h4 class="panel-title">
					<a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
					  GRU
					</a>
				  </h4>
				</div>
				<div id="collapseTwo" class="panel-collapse collapse <#if collapseAccordion=2>in</#if>" role="tabpanel" aria-labelledby="headingTwo">
				  <div class="panel-body">
					<ul class="nav nav-pills nav-stacked" id="navTabs" role="tablist">
						<li class="<#if tab="openam"> active</#if>" id="openAmTab"><a href="jsp/site/Portal.jsp?page=openam&id=${application.id}">#i18n{appcenter.tabs.openam}</a></li>
						<li class="<#if tab="moncompte_settings"> active</#if>" id="myAccountTab"><a href="jsp/site/Portal.jsp?page=moncomptesettings&id=${application.id}">#i18n{module.appcenter.moncomptesettings.tabs.moncomptesettings}</a></li>
						<li class="<#if tab="notification_gru"> active</#if>" id="notificationGruTab"><a href="jsp/site/Portal.jsp?page=notificationgru&id=${application.id}">#i18n{module.appcenter.notificationgru.tabs.notificationgru}</a></li>
						<li class="<#if tab="identitystore"> active</#if>" id="myAccountTab"><a href="jsp/site/Portal.jsp?page=identitystore&id=${application.id}">#i18n{appcenter.tabs.identitystore}</a></li>
					</ul>
				  </div>
				</div>
			</div>
			<div class="panel panel-default">
				<div class="panel-heading" role="tab" id="headingThree">
				  <h4 class="panel-title">
					<a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
					  Guichet Professionnel
					</a>
				  </h4>
				</div>
				<div id="collapseThree" class="panel-collapse collapse <#if collapseAccordion=3>in</#if>" role="tabpanel" aria-labelledby="headingThree">
				  <div class="panel-body">
					<ul class="nav nav-pills nav-stacked" id="navTabs" role="tablist">
                                                <li class="<#if tab="guichet_pro"> active</#if>" id="guichetProTab"><a href="jsp/site/Portal.jsp?page=guichetpro&id=${application.id}">#i18n{module.appcenter.guichetpro.tabs.guichetpro}</a></li>
					</ul>
				  </div>
				</div>
			</div>
		</div>
	</div>
	<div class="col-xs-12 col-sm-9">
		<div class="tab-content" id="tabContent">
			<div class="tab-pane fade in active" id="" role="tabpanel" aria-labelledby="">
				<#nested>
			</div>
		</div>
	</div>
</div>
</#macro>


<!-- Modal -->
<div id="ModalModify" class="modal fade" role="dialog" aria-labelledby="modalTitleModifyAppDescription">
	<div class="modal-dialog" role="document">
		<!-- Modal content-->
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">&times;</button>
				<h2 class="modal-title" id="modalTitleModifyAppDescription">#i18n{appcenter.modify_application.modalTitleModifyAppDescription}</h2>
			</div>
            <form action="jsp/site/Portal.jsp">
                <input type="hidden" name="page" value="application">
				<fieldset>
					<div class="modal-body">
						<input type="hidden" id="id" name="id" value="${application.id}">
						<div class="form-group">
							<label for="name" class="col-form-label">#i18n{appcenter.modify_application.labelCode}
							</label>
							<input type="text" id="code" name="code" maxlength="50" value="${application.code!}" class="form-control">
						</div>
						<div class="form-group">
							<label for="name" class="col-form-label">#i18n{appcenter.modify_application.labelName} <@icon style="asterisk" />
							</label>
							<input type="text" id="name" name="name" maxlength="50" value="${application.name}" class="form-control" required >
						</div>
						<div class="form-group">
							<label for="description" class="col-form-label">#i18n{appcenter.modify_application.labelDescription} <@icon style="asterisk" />
							</label>
							<input type="text" id="description" name="description" maxlength="255" value="${application.description}" class="form-control" required >
						</div>
					</div>
					<div class="modal-footer">
						<button type="submit" name="action_modifyApplication" class="btn btn-primary">#i18n{portal.util.labelModify}</button>
						<button type="button" class="btn btn-default" data-dismiss="modal">#i18n{portal.util.labelCancel}</button>
					</div>
				</fieldset>
			</form>
		</div>
	</div>
</div>

<!-- Modal -->
<div id="ModalAddUser" class="modal fade" role="dialog" aria-labelledby="modalTitleAddUser">
	<div class="modal-dialog" role="document">
		<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">&times;</button>
					<h2 class="modal-title" id="modalTitleAddUser">#i18n{appcenter.modify_application.modalTitleAddUser}</h2>
				</div>
				<form action="jsp/site/Portal.jsp">
                                    <input type="hidden" name="page" value="application" />
					<input type="hidden" id="id" name="id" value="${application.id}"/>
					<fieldset>
					<div class="modal-body">
						<div>
							<h5>#i18n{appcenter.modify_application.titleAuthorizedUsers}</h5>
							<ul class="userList">
							<#list application.authorizations as userAuthorized>
								<li>
									<@icon style="user" /> ${userAuthorized.userId} (${userAuthorized.userRoleName})
									<#if user.admin>
									<a class="text-danger" href='jsp/site/Portal.jsp?page=application&action=removeUser&id=${application.id}&user_email=${userAuthorized.userId}' title="#i18n{portal.util.labelDelete}">
										<span class="fa fa-trash"></span>
									</a> 
									</#if>    
								</li>
							</#list>
							</ul>
						</div>
					
						<div class="form-group">
							<label for="user_email" class="col-form-label">#i18n{appcenter.modify_application.labelUserEmail} <@icon style="asterisk" />
							</label>
							<input type="text" id="user_email" name="user_email" maxlength="50" value="" class="form-control" required />
						</div>
						<div class="form-group">
							<label for="user_role" class="col-form-label">#i18n{appcenter.modify_application.labelRole} <@icon style="asterisk" />
							</label>
							<select id="user_role" name="user_role" class="form-control">
								<#if user.delegateRoles?has_content>
								<#list user.delegateRoles as item>
        								<option value="${item.code}" <#if !item.name?has_content>label="${i18n("portal.util.labelEmpty")}"</#if>>${item.name}</option>
								</#list>
								</#if>
							</select>
						</div>
					</div>
					<div class="modal-footer">
						<button type="submit" name="action_addUser" class="btn btn-primary">#i18n{appcenter.modify_application.buttonAdd}</button>
						<button type="button" class="btn btn-default" data-dismiss="modal">#i18n{portal.util.labelCancel}</button>
					</div>
				</fieldset>
			</form>
		</div>
	</div>
</div>
    
    
