<#include "../../appcenter_tabs.html" />
<@tabs2 tab="sources" application=application />


<h1>#i18n{appcenter.manage_sources.title}</h1>

    <div class="well">
        <h3>#i18n{appcenter.manage_sources.labelSiteRepository} </h3> 
            <#if data?? && data.siteRepository ??>
            <a href="${data.siteRepository}" target="_blank">${data.siteRepository}</a> 
                    <br><br>
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#ModalAccessDemand">
                        #i18n{appcenter.manage_sources.requestSiteRepositoryAccessButton}
                    </button>
                    <br><br>
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#ModalModifySiteRepository">
                        #i18n{appcenter.manage_sources.modifySiteRepositoryButton}
                    </button>
                    <#if 0 < demands?size>
                        <ul>
                        <#list demands as demand>
                        <li>
                            ${demand.statusText!'TODO STATUS TEXT'}
                            ${demand.demandContent!'TODO DEMAND CONTENT'}
                            ${(demands_states[demand.id?string].name)!'TODO DEMAND STATE NAME'}
                            ${(demands_states[demand.id?string].description)!'TODO DEMAND STATE DESCIPTION'}
                        </li>
                        </#list>
                        </ul>
                    </#if>
            <#else>   
                <form action="jsp/site/Portal.jsp">
                    <input type="hidden" name="page" value="sources" />
                    <input type="hidden" name="id" value="${application.id}" />
                    <input type="hidden" name="action" value="addSiteRepository" />
                    <@formGroup labelFor='site_repository' labelKey='#i18n{appcenter.manage_sources.labelSiteRepository}' mandatory=true>
                        <@input type='text' id='site_repository' name='site_repository'  maxlength=250 tabIndex='0' />
                    </@formGroup>
                    <br><br>
                    <button class="btn btn-primary" type="submit">
                        #i18n{appcenter.manage_sources.addSiteRepositoryButton}
                    </button>
                </form>
            </#if>
    </div>

    <!-- Modal -->
    <div id="ModalAccessDemand" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">#i18n{appcenter.manage_sources.modalTitle.requestSiteRepositoryAccess}</h4>
                </div>
                <div class="modal-body">
                    <form action="jsp/site/Portal.jsp">
                        <input type="hidden" name="page" value="sources" />
                        <input type="hidden" name="id" value="${application.id}" />
                        <input type="hidden" name="action" value="addAccessDemand" />
                        <@formGroup labelFor='svn_username' labelKey='#i18n{appcenter.manage_sources.labelSvnAccessDemandUserName}' mandatory=true>
                            <@input type='text' id='svn_username' name='svn_username'  maxlength=250 tabIndex='0' />
                        </@formGroup>
                        <br><br>
                        <button class="btn btn-primary" type="submit">
                            #i18n{appcenter.manage_sources.addSiteRepositoryButton}
                        </button>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    
    <!-- Modal -->
    <div id="ModalModifySiteRepository" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">#i18n{appcenter.manage_sources.modalTitle.modifySiteRepository}</h4>
                </div>
                <div class="modal-body">
                <form action="jsp/site/Portal.jsp">
                    <input type="hidden" name="page" value="sources" />
                    <input type="hidden" name="id" value="${application.id}" />
                    <input type="hidden" name="action" value="addSiteRepository" />
                    <input type="text" name="site_repository" />
                    <br><br>
                    <button class="btn btn-primary" type="submit">
                        #i18n{appcenter.manage_sources.modifySiteRepositoryButton}
                    </button>
                </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>

        </div>
    </div>    