<#macro printDemand demand cpt>
    <div class="panel">
            <div class="panel-heading" role="tab" id="heading${cpt}">
                    <h3 class="panel-title">
                            <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse${cpt}" aria-expanded="false" aria-controls="collapse${cpt}">
                                    Demande #${demand.id}
                            </a>
                    </h3>
            </div>

            <div id="collapse${cpt}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading${cpt}">
                    <div class="panel-body">
                            <table class="table table-responsive">
                                    <tr>
                                            <th>#i18n{appcenter.view_demands.columnStatusText}</th>
                                            <td>${demand.statusText!'TODO STATUS TEXT'}</td>
                                    </tr>
                                    <tr>
                                            <th>#i18n{appcenter.view_demands.columnStateName}</th>
                                            <td>${(demands_states[demand.id?string].name)!'TODO DEMAND STATE NAME'}</td>
                                    </tr>
                                    <tr>
                                            <th>#i18n{appcenter.view_demands.complementaryInfos}</th>
                                            <td>${(demand.complementaryInfos)!''}</td>
                                    </tr>
                            </table>
                            ${(demands_histories[demand.id?string])!'TODO DEMAND HISTORY'}
                    </div>
            </div>
    </div>
</#macro>

<#macro printDemands demands demands_states demands_histories>
	<#if 0 lt demands?size>
		<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
		<#assign cpt = 0 />
		<#list demands as demand>
                    <#if active_demand_type?? >
                        <#if active_demand_type == demand.demandType>
                            <#if active_environment ?? && demand.environment??>
                                <#if demand.environment.prefix == active_environment.prefix >
                                    <@printDemand demand cpt/>
                                </#if>
                            <#else>
                                <@printDemand demand cpt/>
                            </#if>
                        </#if>
                    <#else>
                        <#if active_environment ?? && demand.environment??>
                            <#if demand.environment.prefix == active_environment.prefix >
                                <@printDemand demand cpt/>
                            </#if>
                        <#else>
                            <@printDemand demand cpt/>
                        </#if>
                    </#if>
                    <#assign cpt = cpt + 1 />
		</#list>
		</div>
	</#if>
</#macro>
