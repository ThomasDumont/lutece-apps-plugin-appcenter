<#include "manageappcenter_tabs.html" />
<@tabs2 tab="demand" />

<@box>
	<@boxHeader title='#i18n{appcenter.manage_demand.title}' boxTools=true>
		<@tform class='form-inline pull-right' name='manage_demand' action='jsp/admin/plugins/appcenter/ManageDemands.jsp'>
			<@button type='submit' name='view_createDemand' buttonIcon='plus' title='#i18n{appcenter.manage_demand.buttonAdd}' />
		</@tform>
	</@boxHeader>
	<@boxBody>    
    <@messages infos=infos />
    <@paginationAdmin paginator=paginator combo=1 />
    <div class="clearfix"></div>
    <@table>
        <tr>
            <input type="hidden" id="id" name="id"/>    
            <th>#i18n{appcenter.manage_demands.columnDemandType}</th>
            <th>#i18n{appcenter.manage_demands.columnApplicationName}</th>
            <th>#i18n{appcenter.manage_demands.columnWorkflowStatus}</th>
            <th>#i18n{appcenter.manage_demands.columnStatusText}</th>
            <th>#i18n{appcenter.manage_demands.columnCreationDate}</th>
            <th>#i18n{portal.util.labelActions}</th>
        </tr>
        <@tableHeadBodySeparator />
            <#list demand_list as demand >
                <tr>
                    <input type="hidden" id="id" name="id"/>
                    <td>
                        ${demand.demandType!''}
                    </td>
                    <td>
                        ${(applications[demand.idApplication?string].name)!''}
                    </td>
                    <td>
                        ${(states[demand.id?string].name)!''}
                    </td>
                    <td>
                        ${demand.statusText!''}
                    </td>
                    <td>
                    	 ${demand.creationDate}
	                <td>
	                		<@aButton href='jsp/admin/plugins/appcenter/ManageDemands.jsp?view=demandHistory&id=${demand.id}' title='#i18n{appcenter.manage_demands.action_viewHistory}' buttonIcon='pencil' showTitle=false />
				
		                  <#assign listActions = actions[demand.id?string] />
		                  <#if listActions??>
		           			<#list listActions  as action>
		           				<@aButton href='jsp/admin/plugins/appcenter/ManageDemands.jsp?action=processAction&id=${demand.id}&id_action=${action.id}' title='${action.name}' buttonIcon='pencil' showTitle=true />
		     				</#list>
						 </#if>
	                </td>
                </tr>
            </#list>
    </@table>

    <@paginationAdmin paginator=paginator />

  </@boxBody>
</@box>
